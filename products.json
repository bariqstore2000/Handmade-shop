<script>
  const container = document.getElementById("productsContainer");

  function renderProducts(products) {
    if (!products.length) {
      container.innerHTML = "<p style='text-align:center;color:#777;'>لا توجد منتجات حالياً</p>";
      return;
    }

    products.forEach((product) => {
      const card = document.createElement("div");
      card.className = "product-card";
      card.onclick = () => {
        localStorage.setItem("selectedProduct", JSON.stringify(product));
        window.location.href = "product.html";
      };

      card.innerHTML = `
        <img src="${product.image}" alt="${product.name}">
        <h3>${product.name}</h3>
        <p>${product.price} جنيه</p>
      `;

      container.appendChild(card);
    });
  }

  let products = JSON.parse(localStorage.getItem("products") || "[]");

  if (products.length) {
    renderProducts(products);
  } else {
    // تحميل من ملف JSON خارجي (في أول مرة)
    fetch("data/products.json")
      .then((res) => res.json())
      .then((data) => {
        localStorage.setItem("products", JSON.stringify(data));
        renderProducts(data);
      })
      .catch((err) => {
        console.error("حدث خطأ:", err);
        container.innerHTML = "<p style='text-align:center;color:#777;'>تعذر تحميل المنتجات</p>";
      });
  }
</script>
